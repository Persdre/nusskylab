!function(e){"use strict";var t=e.tablesorter,o=".tscolsel",l=t.columnSelector={queryAll:"@media only all { [columns] { display: none; } } ",queryBreak:"@media all and (min-width: [size]) { [columns] { display: table-cell; } } ",init:function(t,n,a){var c,r;return c=e(a.columnSelector_layout),c.find("input").add(c.filter("input")).length?(n.$table.addClass(n.namespace.slice(1)+"columnselector"),r=n.selector={$container:e(a.columnSelector_container||"<div>")},r.$style=e("<style></style>").prop("disabled",!0).appendTo("head"),r.$breakpoints=e("<style></style>").prop("disabled",!0).appendTo("head"),r.isInitializing=!0,l.setupSelector(n,a),a.columnSelector_mediaquery&&l.setupBreakpoints(n,a),r.isInitializing=!1,r.$container.length?l.updateCols(n,a):n.debug&&console.warn("ColumnSelector: >> container not found"),void n.$table.off("refreshColumnSelector"+o).on("refreshColumnSelector"+o,function(e,t,o){l.refreshColumns(this.config,t,o)})):void(n.debug&&console.error("ColumnSelector: >> ERROR: Column Selector aborting, no input found in the layout! ***"))},refreshColumns:function(t,o,n){var a,c,r=e.isArray(n||o),u=t.widgetOptions;if("undefined"!=typeof o&&t.selector.$container.length){if("selectors"===o&&(t.selector.$container.empty(),l.setupSelector(t,u),l.setupBreakpoints(t,u),"undefined"==typeof n&&(n=t.selector.auto)),r)for(c=n||o,e.each(c,function(e,t){c[e]=parseInt(t,10)}),a=0;a<t.columns;a++)t.selector.$container.find("input[data-column="+a+"]").prop("checked",e.inArray(a,c)>=0);l.updateAuto(t,u,t.selector.$container.find('input[data-column="auto"]').prop("checked",n===!0||o===!0||"auto"===o&&n!==!1))}else l.updateBreakpoints(t,u),l.updateCols(t,u)},setupSelector:function(o,n){var a,c=o.selector,r=c.$container,u=n.columnSelector_saveColumns&&t.storage,s=u?t.storage(o.table,"tablesorter-columnSelector"):[],i=u?t.storage(o.table,"tablesorter-columnSelector-auto"):{};c.auto=e.isEmptyObject(i)||"boolean"!==e.type(i.auto)?n.columnSelector_mediaqueryState:i.auto,c.states=[],c.$column=[],c.$wrapper=[],c.$checkbox=[],o.$table.children("thead").find("tr:first th",o.table).each(function(){var u=e(this),i=u.attr(n.columnSelector_priority)||1,d=u.attr("data-column"),p=t.getData(this,o.headers[d],"columnSelector");return isNaN(i)&&i.length>0||"disable"===p||n.columnSelector_columns[d]&&"disable"===n.columnSelector_columns[d]?!0:(c.states[d]=s&&"undefined"!=typeof s[d]?s[d]:"undefined"!=typeof n.columnSelector_columns[d]?n.columnSelector_columns[d]:"true"===p||"false"!==p,c.$column[d]=e(this),a=u.attr(n.columnSelector_name)||u.text(),void(r.length&&(c.$wrapper[d]=e(n.columnSelector_layout.replace(/\{name\}/g,a)).appendTo(r),c.$checkbox[d]=c.$wrapper[d].find("input").add(c.$wrapper[d].filter("input")).attr("data-column",d).toggleClass(n.columnSelector_cssChecked,c.states[d]).prop("checked",c.states[d]).on("change",function(){c.states[d]=this.checked,l.updateCols(o,n)}).change())))})},setupBreakpoints:function(t,n){var a=t.selector;n.columnSelector_mediaquery&&(a.lastIndex=-1,l.updateBreakpoints(t,n),t.$table.off("updateAll"+o).on("updateAll"+o,function(){l.updateBreakpoints(t,n),l.updateCols(t,n)})),a.$container.length&&(n.columnSelector_mediaquery&&(a.$auto=e(n.columnSelector_layout.replace(/\{name\}/g,n.columnSelector_mediaqueryName)).prependTo(a.$container),a.$auto.find("input").add(a.$auto.filter("input")).attr("data-column","auto").prop("checked",a.auto).toggleClass(n.columnSelector_cssChecked,a.auto).on("change",function(){l.updateAuto(t,n,e(this))}).change()),t.$table.off("update"+o).on("update"+o,function(){l.updateCols(t,n)}))},updateAuto:function(o,n,a){var c=o.selector;c.auto=a.prop("checked")||!1,e.each(c.$checkbox,function(e,t){t&&(t[0].disabled=c.auto,c.$wrapper[e].toggleClass("disabled",c.auto))}),n.columnSelector_mediaquery&&l.updateBreakpoints(o,n),l.updateCols(o,n),o.selector.$popup&&o.selector.$popup.find(".tablesorter-column-selector").html(c.$container.html()).find("input").each(function(){var t=e(this).attr("data-column");e(this).prop("checked","auto"===t?c.auto:c.states[t])}),n.columnSelector_saveColumns&&t.storage&&t.storage(o.$table[0],"tablesorter-columnSelector-auto",{auto:c.auto}),c.auto&&o.$table.trigger(n.columnSelector_updated)},updateBreakpoints:function(t,o){var n,a,c,r,u=t.selector,s=t.namespace+"columnselector",i=[],d="";if(o.columnSelector_mediaquery&&!u.auto)return u.$breakpoints.prop("disabled",!0),void u.$style.prop("disabled",!1);for(n=0;6>n;n++)c=[],t.$headers.filter("["+o.columnSelector_priority+"="+(n+1)+"]").each(function(){a=parseInt(e(this).attr("data-column"),10)+1,r=" col:nth-child("+a+")",c.push(s+r+","+s+"_extra_table"+r),r=" tr th:nth-child("+a+")",c.push(s+r+","+s+"_extra_table"+r),r=" tr td:nth-child("+a+")",c.push(s+r+","+s+"_extra_table"+r)}),c.length&&(i=i.concat(c),d+=l.queryBreak.replace(/\[size\]/g,o.columnSelector_breakpoints[n]).replace(/\[columns\]/g,c.join(",")));u.$style&&u.$style.prop("disabled",!0),i.length&&u.$breakpoints.prop("disabled",!1).html(l.queryAll.replace(/\[columns\]/g,i.join(","))+d)},updateCols:function(o,l){if(!(l.columnSelector_mediaquery&&o.selector.auto||o.selector.isInitializing)){var n,a,c=o.selector,r=[],u=o.namespace+"columnselector";c.$container.find("input[data-column]").filter('[data-column!="auto"]').each(function(){this.checked||(n=parseInt(e(this).attr("data-column"),10)+1,a=" col:nth-child("+n+")",r.push(u+a+","+u+"_extra_table"+a),a=" tr th:nth-child("+n+")",r.push(u+a+","+u+"_extra_table"+a),a=" tr td:nth-child("+n+")",r.push(u+a+","+u+"_extra_table"+a)),e(this).toggleClass(l.columnSelector_cssChecked,this.checked)}),l.columnSelector_mediaquery&&c.$breakpoints.prop("disabled",!0),c.$style&&c.$style.prop("disabled",!1).html(r.length?r.join(",")+" { display: none; }":""),l.columnSelector_saveColumns&&t.storage&&t.storage(o.$table[0],"tablesorter-columnSelector",c.states),o.$table.trigger(l.columnSelector_updated)}},attachTo:function(t,o){t=e(t)[0];var l,n,a,c=t.config,r=e(o);r.length&&c&&(r.find(".tablesorter-column-selector").length||r.append('<span class="tablesorter-column-selector"></span>'),l=c.selector,n=c.widgetOptions,r.find(".tablesorter-column-selector").html(l.$container.html()).find("input").each(function(){var t=e(this).attr("data-column"),o="auto"===t?l.auto:l.states[t];e(this).toggleClass(n.columnSelector_cssChecked,o).prop("checked",o)}),l.$popup=r.on("change","input",function(){a=e(this).toggleClass(n.columnSelector_cssChecked,this.checked).attr("data-column"),l.$container.find('input[data-column="'+a+'"]').prop("checked",this.checked).trigger("change")}))}};t.addWidget({id:"columnSelector",priority:10,options:{columnSelector_container:null,columnSelector_columns:{},columnSelector_saveColumns:!0,columnSelector_layout:'<label><input type="checkbox">{name}</label>',columnSelector_name:"data-selector-name",columnSelector_mediaquery:!0,columnSelector_mediaqueryName:"Auto: ",columnSelector_mediaqueryState:!0,columnSelector_breakpoints:["20em","30em","40em","50em","60em","70em"],columnSelector_priority:"data-priority",columnSelector_cssChecked:"checked",columnSelector_updated:"columnUpdate"},init:function(e,t,o,n){l.init(e,o,n)},remove:function(e,t,l,n){if(!n){var a=t.selector;a.$container.empty(),a.$popup&&a.$popup.empty(),a.$style.remove(),a.$breakpoints.remove(),t.$table.off("updateAll"+o+" update"+o)}}})}(jQuery);