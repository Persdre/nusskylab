!function(b){"use strict";var m=b.tablesorter;m.grouping={types:{number:function(r,e,o,t,u){var p,n;return 1<t&&""!==o?e.hasClass(m.css.sortAsc)?(p=Math.floor(parseFloat(o)/t)*t)>parseFloat(u||0)?p:parseFloat(u||0):(p=Math.ceil(parseFloat(o)/t)*t)<parseFloat(u||t)-p?parseFloat(u||t)-p:p:(n=(o+"").match(/\d+/g))&&n.length>=t?n[t-1]:o||""},separator:function(r,e,o,t){var u=(o+"").split(r.widgetOptions.group_separator);return b.trim(u&&0<t&&u.length>=t?u[(t||1)-1]:"")},word:function(r,e,o,t){var u=(o+" ").match(/\w+/g);return u&&u.length>=t?u[t-1]:o||""},letter:function(r,e,o,t){return o?(o+" ").substring(0,t):""},date:function(r,e,o,t){var u=r.widgetOptions,p=new Date(o||""),n=p.getHours();return"year"===t?p.getFullYear():"month"===t?u.group_months[p.getMonth()]:"monthyear"===t?u.group_months[p.getMonth()]+" "+p.getFullYear():"day"===t?u.group_months[p.getMonth()]+" "+p.getDate():"week"===t?u.group_week[p.getDay()]:"time"===t?("00"+(12<n?n-12:0===n?n+12:n)).slice(-2)+":"+("00"+p.getMinutes()).slice(-2)+" "+("00"+u.group_time[12<=n?1:0]).slice(-2):u.group_dateString(p)}},update:function(p,r,n){if(!b.isEmptyObject(r.cache)){var e,o,t,u,a,g,s,l,i,c="undefined"!=typeof r.sortList[0],d="",_=0,h=!1,f="undefined"!=typeof n.group_forceColumn[0]?n.group_enforceSort&&!c?-1:n.group_forceColumn[0]:c?r.sortList[0][0]:-1;if(r.$table.find("tr.group-hidden").removeClass("group-hidden").end().find("tr.group-header").remove(),n.group_collapsible&&r.$table.data("pagerSavedHeight",0),0<=f&&f<r.columns&&!r.$headerIndexed[f].hasClass("group-false")){for(n.group_currentGroup="",n.group_currentGroups={},g=(a=(r.$headerIndexed[f].attr("class")||"").match(/(group-\w+(-\w+)?)/g))?a[0].split("-"):["group","letter",1],n.group_collapsible&&n.group_saveGroups&&m.storage&&(n.group_currentGroups=m.storage(p,"tablesorter-groups")||{},i="dir"+r.sortList[0][1],l=n.group_currentGroup=""+r.sortList[0][0]+i+g.join(""),n.group_currentGroups[l]?h=!0:n.group_currentGroups[l]=[]),o=0;o<r.$tbodies.length;o++)for(s=r.cache[o].normalized,d="",u=r.$tbodies.eq(o).children("tr").not("."+r.cssChildRow),e=0;e<u.length;e++)u.eq(e).is(":visible")&&m.grouping.types[g[1]]&&(d!==(t=s[e]?m.grouping.types[g[1]](r,r.$headerIndexed[f],s[e][f],/date/.test(a)?g[2]:parseInt(g[2]||1,10)||1,d):t)&&(d=t,"number"===g[1]&&1<g[2]&&""!==t&&(t+=" - "+(parseInt(t,10)+(parseInt(g[2],10)-1)*(r.$headerIndexed[f].hasClass(m.css.sortAsc)?1:-1))),b.isFunction(n.group_formatter)&&(t=n.group_formatter((t||"").toString(),f,p,r,n)||t),u.eq(e).before('<tr class="group-header '+r.selectorRemove.slice(1)+'" unselectable="on" '+(r.tabIndex?'tabindex="0" ':"")+'data-group-index="'+_+++'"><td colspan="'+r.columns+'">'+(n.group_collapsible?"<i/>":"")+'<span class="group-name">'+t+'</span><span class="group-count"></span></td></tr>'),n.group_saveGroups&&!h&&n.group_collapsed&&n.group_collapsible&&n.group_currentGroups[n.group_currentGroup].push(t)));r.$table.find("tr.group-header").bind("selectstart",!1).each(function(){var r,e,o,t=b(this),u=t.nextUntil("tr.group-header").filter(":visible");(n.group_count||b.isFunction(n.group_callback))&&((e=t.find(".group-count")).length&&(n.group_count&&e.html(n.group_count.replace(/\{num\}/g,u.length)),b.isFunction(n.group_callback)&&n.group_callback(t.find("td"),u,f,p))),n.group_saveGroups&&!b.isEmptyObject(n.group_currentGroups)&&n.group_currentGroups[n.group_currentGroup].length?(o=t.find(".group-name").text().toLowerCase()+t.attr("data-group-index"),r=-1<b.inArray(o,n.group_currentGroups[n.group_currentGroup]),t.toggleClass("collapsed",r),u.toggleClass("group-hidden",r)):n.group_collapsed&&n.group_collapsible&&(t.addClass("collapsed"),u.addClass("group-hidden"))}),r.$table.trigger(n.group_complete)}}},bindEvents:function(p,n,a){a.group_collapsible&&(a.group_currentGroups=[],n.$table.on("click toggleGroup keyup","tr.group-header",function(r){if(r.stopPropagation(),"keyup"!==r.type||13===r.which){var e,o,t=b(this),u=t.find(".group-name").text().toLowerCase()+t.attr("data-group-index");!r.shiftKey||"click"!==r.type&&"keyup"!==r.type||t.siblings(".group-header").trigger("toggleGroup"),t.toggleClass("collapsed"),t.nextUntil("tr.group-header").toggleClass("group-hidden",t.hasClass("collapsed")),a.group_saveGroups&&m.storage&&(n.$table.find(".group-header"),e=t.hasClass("collapsed"),a.group_currentGroups[a.group_currentGroup]||(a.group_currentGroups[a.group_currentGroup]=[]),e&&a.group_currentGroup?a.group_currentGroups[a.group_currentGroup].push(u):a.group_currentGroup&&(-1<(o=b.inArray(u,a.group_currentGroups[a.group_currentGroup]))&&a.group_currentGroups[a.group_currentGroup].splice(o,1)),m.storage(p,"tablesorter-groups",a.group_currentGroups))}})),b(a.group_saveReset).on("click",function(){m.grouping.clearSavedGroups(p)}),n.$table.on("pagerChange.tsgrouping",function(){m.grouping.update(p,n,a)})},clearSavedGroups:function(r){r&&m.storage&&(m.storage(r,"tablesorter-groups",""),m.grouping.update(r,r.config,r.config.widgetOptions))}},m.addWidget({id:"group",priority:100,options:{group_collapsible:!0,group_collapsed:!1,group_saveGroups:!0,group_saveReset:null,group_count:" ({num})",group_separator:"-",group_formatter:null,group_callback:null,group_complete:"groupingComplete",group_forceColumn:[],group_enforceSort:!0,group_checkbox:["checked","unchecked"],group_months:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],group_week:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],group_time:["AM","PM"],group_dateString:function(r){return r.toLocaleString()}},init:function(r,e,o,t){m.grouping.bindEvents(r,o,t)},format:function(r,e,o){m.grouping.update(r,e,o)},remove:function(r,e){e.$table.off("click","tr.group-header").off("pagerChange.tsgrouping").find(".group-hidden").removeClass("group-hidden").end().find("tr.group-header").remove()}})}(jQuery);