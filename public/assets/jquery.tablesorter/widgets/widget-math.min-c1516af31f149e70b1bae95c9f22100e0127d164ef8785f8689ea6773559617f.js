!function(g){"use strict";var f=g.tablesorter,p={error:{0:"Infinity result: Divide by zero",1:"Need more than one element to make this calculation",undef:"No elements found"},invalid:function(t,e){return console.log(t,p.error[e]),"none"},events:"tablesorter-initialized update updateAll updateRows addRows updateCell filterReset filterEnd ".split(" ").join(".tsmath "),processText:function(t,e){var a=e.attr(t.textAttribute);return void 0===a&&(a=e[0].textContent||e.text()),a=f.formatFloat(a.replace(/[^\w,. \-()]/g,""),t.table)||0,isNaN(a)?0:a},getRow:function(t,e){var a=t.widgetOptions,n=[],r=e.closest("tr"),o=r.children().not("["+a.math_dataAttrib+"=ignore]");return r.hasClass(a.filter_filteredRow||"filtered")||(a.math_ignore.length&&(o=o.not("[data-column="+a.math_ignore.join("],[data-column=")+"]")),n=o.not(e).map(function(){return p.processText(t,g(this))}).get()),n},getColumn:function(t,e,a){var n,r,o,i,l,u=[],s=t.widgetOptions,h=s.filter_filteredRow||"filtered",d=parseInt(e.attr("data-column"),10),c=t.$table.children("tbody").children(),m=e.closest("tr");if("above"===a)for(n=o=c.index(m);0<=n;)l=(r=c.eq(n).children().filter("[data-column="+d+"]")).filter("["+s.math_dataAttrib+"^=above]").length,(!c.eq(n).hasClass(h)&&c.eq(n).not("["+s.math_dataAttrib+"=ignore]").length&&n!==o||l&&n!==o)&&(l?n=0:r.length&&u.push(p.processText(t,r))),n--;else for(o=(i=c.not("["+s.math_dataAttrib+"=ignore]")).length,n=0;n<o;n++)r=i.eq(n).children().filter("[data-column="+d+"]"),i.eq(n).hasClass(h)||!r.not("["+s.math_dataAttrib+"^=above],["+s.math_dataAttrib+"^=col]").length||r.is(e)||u.push(p.processText(t,r));return u},getAll:function(t){var e,a,n,r,o,i,l,u,s=[],h=t.widgetOptions,d=h.filter_filteredRow||"filtered",c=t.$table.children("tbody").children().not("["+h.math_dataAttrib+"=ignore]");for(o=c.length,r=0;r<o;r++)if(!(n=c.eq(r)).hasClass(d))for(u=(i=n.children().not("["+h.math_dataAttrib+"=ignore]")).length,l=0;l<u;l++)e=i.eq(l),a=parseInt(e.attr("data-column"),10),!e.filter("["+h.math_dataAttrib+"]").length&&g.inArray(a,h.math_ignore)<0&&s.push(p.processText(t,e));return s},recalculate:function(t,e,a){if(t&&(!e.math_isUpdating||a)){a&&f.computeColumnIndex(t.$table.children("tbody").children()),e.math_dataAttrib="data-"+(e.math_data||"math");var n=t.$tbodies.find("["+e.math_dataAttrib+"]");p.mathType(t,n,e.math_priority),n=t.$table.children("."+t.cssInfoBlock+", tfoot").find("["+e.math_dataAttrib+"]"),p.mathType(t,n,e.math_priority),n=t.$table.find("["+e.math_dataAttrib+"^=all]"),p.mathType(t,n,["all"]),e.math_isUpdating=!0,t.debug&&console[console.group?"group":"log"]("Math widget triggering an update after recalculation"),t.$table.trigger("update")}},mathType:function(a,n,t){if(n.length){var r,o,i,l,u,s,h,d,c=a.widgetOptions,m=f.equations;"all"===t[0]&&(u=p.getAll(a)),a.debug&&console[console.group?"group":"log"]("Tablesorter Math widget recalculation"),g.each(t,function(t,e){if(s=n.filter("["+c.math_dataAttrib+"^="+e+"]"),d=s.length){for(a.debug&&console[console.group?"group":"log"](e),h=0;h<d;h++)i=s.eq(h),r=(i.attr(c.math_dataAttrib)||"").replace(e+"-",""),l="row"===e?p.getRow(a,i):"all"===e?u:p.getColumn(a,i,e),m[r]&&(l.length?(o=m[r](l),a.debug&&console.log(i.attr(c.math_dataAttrib),l,"=",o)):o=p.invalid(r,"mean"===r?0:"undef"),p.output(i,c,o,l));a.debug&&console.groupEnd&&console.groupEnd()}}),a.debug&&console.groupEnd&&console.groupEnd()}},output:function(t,e,a,n){var r=t.attr("data-"+e.math_data+"-mask")||e.math_mask,o=f.formatMask(r,a,e.math_wrapPrefix,e.math_wrapSuffix);"function"==typeof e.math_complete&&(o=e.math_complete(t,e,o,a,n)),!1!==o&&t.html(o)}};f.formatMask=function(t,e,a,n){if(!t||isNaN(+e))return e;var r,o,i,l,u,s,h,d,c,m,g,f,p,b,_="",v=t.length,A=t.search(/[0-9\-\+#]/),y=0<A?t.substring(0,A):"",x=y;if(0<A&&a&&(x=/\{content\}/.test(a||"")?(a||"").replace(/\{content\}/g,y||""):(a||"")+y),p=v-(b=t.split("").reverse().join("").search(/[0-9\-\+#]/)),p+="."===t.substring(p,p+1)?1:0,""!==(_=y=0<b?t.substring(p,v):"")&&n&&(_=/\{content\}/.test(n||"")?(n||"").replace(/\{content\}/g,y||""):y+(n||"")),r=(e="-"==(t=t.substring(A,p)).charAt(0)?-e:+e)<0?e=-e:0,i=(o=t.match(/[^\d\-\+#]/g))&&o[o.length-1]||".",l=o&&o[1]&&o[0]||",",t=t.split(i),e=+(e=e.toFixed(t[1]&&t[1].length))+"",s=t[1]&&t[1].lastIndexOf("0"),(!(d=e.split("."))[1]||d[1]&&d[1].length<=s)&&(e=(+e).toFixed(s+1)),c=t[0].split(l),t[0]=c.join(""),-1<(u=t[0]&&t[0].indexOf("0")))for(;d[0].length<t[0].length-u;)d[0]="0"+d[0];else 0==+d[0]&&(d[0]="");if((e=e.split("."))[0]=d[0],h=c[1]&&c[c.length-1].length){for(g="",f=(m=e[0]).length%h,v=m.length,p=0;p<v;p++)g+=m.charAt(p),!((p-f+1)%h)&&p<v-h&&(g+=l);e[0]=g}return e[1]=t[1]&&e[1]?i+e[1]:"",x+(r?"-":"")+e[0]+e[1]+_},f.equations={count:function(t){return t.length},sum:function(t){var e,a=t.length,n=0;for(e=0;e<a;e++)n+=t[e];return n},mean:function(t){return f.equations.sum(t)/t.length},median:function(t){var e,a=t.length;return 1<a?(t.sort(function(t,e){return t-e}),e=Math.floor(a/2),a%2?t[e]:(t[e-1]+t[e])/2):p.invalid("median",1)},mode:function(t){var e,a,n,r={},o=1,i=[t[0]];for(e=0;e<t.length;e++)r[a=t[e]]=r[a]?r[a]+1:1,o<(n=r[a])?(i=[a],o=n):n===o&&(i.push(a),o=n);return i.sort(function(t,e){return t-e})},max:function(t){return Math.max.apply(Math,t)},min:function(t){return Math.min.apply(Math,t)},range:function(t){var e=t.sort(function(t,e){return t-e});return e[t.length-1]-e[0]},variance:function(t,e){for(var a,n=f.equations.mean(t),r=0,o=t.length;o--;)r+=Math.pow(t[o]-n,2);return 0===(a=t.length-(e?0:1))?p.invalid("variance",0):r/=a},varp:function(t){return f.equations.variance(t,!0)},vars:function(t){return f.equations.variance(t)},stdevs:function(t){var e=f.equations.variance(t);return Math.sqrt(e)},stdevp:function(t){var e=f.equations.variance(t,!0);return Math.sqrt(e)}},f.addWidget({id:"math",priority:100,options:{math_data:"math",math_ignore:[],math_mask:"#,##0.00",math_complete:null,math_priority:["row","above","col"],math_prefix:"",math_suffix:"",math_event:"recalculate"},init:function(t,e,a,n){var r=f.hasWidget(t,"filter")?"filterEnd":"updateComplete";a.$table.off((p.events+" updateComplete.tsmath "+n.math_event).replace(/\s+/g," ")).on(p.events+" "+n.math_event,function(t){var e="tablesorter-initialized"===t.type;(!n.math_isUpdating||e)&&(/filter/.test(t.type)||f.computeColumnIndex(a.$table.children("tbody").children()),p.recalculate(a,n,e))}).on(r+".tsmath",function(){setTimeout(function(){n.math_isUpdating&&a.debug&&console.groupEnd&&console.groupEnd(),n.math_isUpdating=!1},40)}),n.math_isUpdating=!1,t.hasInitialized&&p.recalculate(a,n,!0)},remove:function(t,e,a,n){n||e.$table.off((p.events+" updateComplete.tsmath "+a.math_event).replace(/\s+/g," ")).find("[data-"+a.math_data+"]").empty()}})}(jQuery);