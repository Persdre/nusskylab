!function(b){"use strict";var y=b.tablesorter,R=y.output={event:"outputTable",regexQuote:/([\n\t\x09\x0d\x0a]|<[^<]+>)/,regexBR:/(<br([\s\/])?>|\n)/g,regexIMG:/<img[^>]+alt\s*=\s*['"]([^'"]+)['"][^>]*>/i,regexHTML:/<[^<]+>/g,replaceCR:"\r\n",replaceTab:"\t",popupTitle:"Output",popupStyle:"width:100%;height:100%;",message:"Your device does not support downloading. Please try again in desktop browser.",init:function(e){e.$table.off(R.event).on(R.event,function(t){t.stopPropagation(),R.process(e,e.widgetOptions)})},processRow:function(t,e,o,u){var n,r,a,p,i,l,s,c,d,f,w=t.widgetOptions,_=[],h=w.output_duplicateSpans,g=o&&u&&w.output_headerRows&&b.isFunction(w.output_callbackJSON),m=0,v=e.length;for(p=0;p<v;p++)for(_[p]||(_[p]=[]),m=0,a=(r=e.eq(p).children()).length,s=0;s<a;s++){if((n=r.eq(s)).filter("[rowspan]").length)for(c=parseInt(n.attr("rowspan"),10)-1,f=R.formatData(t,w,n,o),i=1;i<=c;i++)_[p+i]||(_[p+i]=[]),_[p+i][m]=o?f:h?f:"";if(n.filter("[colspan]").length)for(d=parseInt(n.attr("colspan"),10)-1,f=R.formatData(t,w,n,o),l=1;l<=d;l++)if(n.filter("[rowspan]").length)for(c=parseInt(n.attr("rowspan"),10),i=0;i<c;i++)_[p+i]||(_[p+i]=[]),_[p+i][m+l]=g?w.output_callbackJSON(n,f,m+l)||f+"("+(m+l)+")":o?f:h?f:"";else _[p][m+l]=g?w.output_callbackJSON(n,f,m+l)||f+"("+(m+l)+")":o?f:h?f:"";for(;"undefined"!=typeof _[p][m];)m++;_[p][m]=_[p][m]||R.formatData(t,w,n,o),m++}return y.output.removeColumns(t,w,_)},removeColumns:function(t,e,o){var u,n,r,a=[],p=o.length;for(u=0;u<p;u++)for(n=o[u],a[u]=[],r=0;r<t.columns;r++)e.output_hiddenColumnArray[r]||a[u].push(n[r]);return a},process:function(t,e){var o,u,n,r,a,p,i,l,s=window.JSON&&JSON.hasOwnProperty("stringify"),c=0,d=(e.output_separator||",").toLowerCase(),f="json"===d,w="array"===d,_=f||w?",":e.output_separator,h=e.output_saveRows,g=t.$table;for(e.output_regex=new RegExp("("+(/\\/.test(_)?"\\":"")+_+")"),e.output_hiddenColumnArray=[],c=0;c<t.columns;c++)e.output_hiddenColumnArray[c]=-1<b.inArray(c,e.output_ignoreColumns)||!e.output_hiddenColumns&&"none"===t.$headerIndexed[c].css("display")&&!t.$headerIndexed[c].hasClass("tablesorter-scroller-hidden-column");if(u=g.find("thead tr").not("."+(y.css.filterRow||"tablesorter-filter-row")).filter(function(){return e.output_hiddenColumns||"none"!==b(this).css("display")}),r=R.processRow(t,u,!0,f),n=g.children("tbody").children("tr"),n=/^f/.test(h)?n.not("."+(e.filter_filteredRow||"filtered")):/^v/.test(h)?n.filter(":visible"):/^[.#:\[]/.test(h)?n.filter(h):n,a=R.processRow(t,n),e.output_includeFooter&&(a=a.concat(R.processRow(t,g.children("tfoot").children("tr:visible")))),p=r.length,f){for(d=[],i=a.length,c=0;c<i;c++)l=r[1<p&&e.output_headerRows?c%p:p-1],d.push(R.row2Hash(l,a[c]));o=s?JSON.stringify(d):d}else l=[r[1<p&&e.output_headerRows?c%p:p-1]],d=R.row2CSV(e,e.output_headerRows?r:l,w).concat(R.row2CSV(e,a,w)),o=w&&s?JSON.stringify(d):d.join("\n");(!b.isFunction(e.output_callback)||e.output_callback(t,o))&&(/p/i.test(e.output_delivery||"")?R.popup(o,e.output_popupStyle,f||w):R.download(e,o))},row2CSV:function(t,e,o){var u,n,r=[],a=e.length;for(n=0;n<a;n++)u=(e[n]||[]).join("").replace(/\"/g,""),0<(e[n]||[]).length&&""!==u&&(r[r.length]=o?e[n]:e[n].join(t.output_separator));return r},row2Hash:function(t,e){var o,u={},n=e.length;for(o=0;o<n;o++)o<t.length&&(u[t[o]]=e[o]);return u},formatData:function(t,e,o,u){var n=o.attr(e.output_dataAttrib),r=void 0!==n?n:o.html(),a=(e.output_separator||",").toLowerCase(),p="json"===a||"array"===a,i=r.replace(/\"/g,e.output_replaceQuote||"\u201c");return r=(i=e.output_trimSpaces?i.replace(R.regexBR,""):i.replace(R.regexBR,R.replaceCR).replace(/\t/g,R.replaceTab)).match(R.regexIMG),e.output_includeHTML||null===r||(i=r[1]),i=e.output_includeHTML&&!u?i:i.replace(R.regexHTML,""),i=e.output_trimSpaces||u?b.trim(i):i,i=(a=!p&&(e.output_wrapQuotes||e.output_regex.test(i)||R.regexQuote.test(i)))?'"'+i+'"':i,"function"==typeof e.output_formatContent?e.output_formatContent(t,e,{isHeader:u,$cell:o,content:i}):i},popup:function(t,e,o){var u=window.open("",R.popupTitle,e);return u.document.write("<html><head><title>"+R.popupTitle+'</title></head><body><textarea wrap="'+(o?"on":"off")+'" style="'+R.popupStyle+'">'+t+"\n</textarea></body></html>"),u.document.close(),u.focus(),!0},download:function(t,e){var o,u,n,r=window.navigator,a=document.createElement("a");if(/(iP)/g.test(r.userAgent))return alert(R.message),!1;try{n=!!new Blob}catch(p){n=!1}return n?(window.URL=window.URL||window.webkitURL,u=new Blob(["\ufeff",e],{type:t.output_encoding}),r.msSaveBlob?r.msSaveBlob(u,t.output_saveFileName):(a.href=window.URL.createObjectURL(u),a.download=t.output_saveFileName,document.createEvent&&((o=document.createEvent("MouseEvents")).initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),a.dispatchEvent(o))),!1):(window.open(t.output_encoding+encodeURIComponent(e)+"?download","_self"),!0)},remove:function(t){t.$table.off(R.event)}};y.addWidget({id:"output",options:{output_separator:",",output_ignoreColumns:[],output_hiddenColumns:!1,output_includeFooter:!1,output_dataAttrib:"data-name",output_headerRows:!1,output_delivery:"popup",output_saveRows:"filtered",output_duplicateSpans:!0,output_replaceQuote:"\u201c;",output_includeHTML:!1,output_trimSpaces:!0,output_wrapQuotes:!1,output_popupStyle:"width=500,height=300",output_saveFileName:"mytable.csv",output_formatContent:null,output_callback:function(){return!0},output_callbackJSON:function(t,e,o){return e+"("+o+")"},output_encoding:"data:application/octet-stream;charset=utf8,"},init:function(t,e,o){R.init(o)},remove:function(t,e){R.remove(e)}})}(jQuery);