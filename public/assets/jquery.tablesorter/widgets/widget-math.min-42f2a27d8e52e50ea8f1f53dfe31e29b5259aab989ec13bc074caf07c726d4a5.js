/*! Widget: math - updated 7/28/2015 (v2.22.4) */
!function(t){"use strict";var e=t.tablesorter,a={error:{0:"Infinity result: Divide by zero",1:"Need more than one element to make this calculation",undef:"No elements found"},invalid:function(t,e){return console.log(t,a.error[e]),"none"},events:"tablesorter-initialized update updateAll updateRows addRows updateCell filterReset filterEnd ".split(" ").join(".tsmath "),processText:function(t,a){var n=a.attr(t.textAttribute);return"undefined"==typeof n&&(n=a[0].textContent||a.text()),n=e.formatFloat(n.replace(/[^\w,. \-()]/g,""),t.table)||0,isNaN(n)?0:n},getRow:function(e,n){var r=e.widgetOptions,o=[],i=n.closest("tr"),l=i.children().not("["+r.math_dataAttrib+"=ignore]");return i.hasClass(r.filter_filteredRow||"filtered")||(r.math_ignore.length&&(l=l.not("[data-column="+r.math_ignore.join("],[data-column=")+"]")),o=l.not(n).map(function(){return a.processText(e,t(this))}).get()),o},getColumn:function(t,e,n){var r,o,i,l,u,s=[],h=t.widgetOptions,d=h.filter_filteredRow||"filtered",c=parseInt(e.attr("data-column"),10),m=t.$table.children("tbody").children(),f=e.closest("tr");if("above"===n)for(i=m.index(f),r=i;r>=0;)o=m.eq(r).children().filter("[data-column="+c+"]"),u=o.filter("["+h.math_dataAttrib+"^=above]").length,(!m.eq(r).hasClass(d)&&m.eq(r).not("["+h.math_dataAttrib+"=ignore]").length&&r!==i||u&&r!==i)&&(u?r=0:o.length&&s.push(a.processText(t,o))),r--;else for(l=m.not("["+h.math_dataAttrib+"=ignore]"),i=l.length,r=0;i>r;r++)o=l.eq(r).children().filter("[data-column="+c+"]"),l.eq(r).hasClass(d)||!o.not("["+h.math_dataAttrib+"^=above],["+h.math_dataAttrib+"^=col]").length||o.is(e)||s.push(a.processText(t,o));return s},getAll:function(e){var n,r,o,i,l,u,s,h,d=[],c=e.widgetOptions,m=c.filter_filteredRow||"filtered",f=e.$table.children("tbody").children().not("["+c.math_dataAttrib+"=ignore]");for(l=f.length,i=0;l>i;i++)if(o=f.eq(i),!o.hasClass(m))for(u=o.children().not("["+c.math_dataAttrib+"=ignore]"),h=u.length,s=0;h>s;s++)n=u.eq(s),r=parseInt(n.attr("data-column"),10),!n.filter("["+c.math_dataAttrib+"]").length&&t.inArray(r,c.math_ignore)<0&&d.push(a.processText(e,n));return d},recalculate:function(t,n,r){if(t&&(!n.math_isUpdating||r)){r&&e.computeColumnIndex(t.$table.children("tbody").children()),n.math_dataAttrib="data-"+(n.math_data||"math");var o=t.$tbodies.find("["+n.math_dataAttrib+"]");a.mathType(t,o,n.math_priority),o=t.$table.children("."+t.cssInfoBlock+", tfoot").find("["+n.math_dataAttrib+"]"),a.mathType(t,o,n.math_priority),o=t.$table.find("["+n.math_dataAttrib+"^=all]"),a.mathType(t,o,["all"]),n.math_isUpdating=!0,t.debug&&console[console.group?"group":"log"]("Math widget triggering an update after recalculation"),t.$table.trigger("update")}},mathType:function(n,r,o){if(r.length){var i,l,u,s,h,d,c,m,f=n.widgetOptions,g=e.equations;"all"===o[0]&&(h=a.getAll(n)),n.debug&&console[console.group?"group":"log"]("Tablesorter Math widget recalculation"),t.each(o,function(t,e){if(d=r.filter("["+f.math_dataAttrib+"^="+e+"]"),m=d.length){for(n.debug&&console[console.group?"group":"log"](e),c=0;m>c;c++)u=d.eq(c),i=(u.attr(f.math_dataAttrib)||"").replace(e+"-",""),s="row"===e?a.getRow(n,u):"all"===e?h:a.getColumn(n,u,e),g[i]&&(s.length?(l=g[i](s),n.debug&&console.log(u.attr(f.math_dataAttrib),s,"=",l)):l=a.invalid(i,"mean"===i?0:"undef"),a.output(u,f,l,s));n.debug&&console.groupEnd&&console.groupEnd()}}),n.debug&&console.groupEnd&&console.groupEnd()}},output:function(t,a,n,r){var o=t.attr("data-"+a.math_data+"-mask")||a.math_mask,i=e.formatMask(o,n,a.math_wrapPrefix,a.math_wrapSuffix);"function"==typeof a.math_complete&&(i=a.math_complete(t,a,i,n,r)),i!==!1&&t.html(i)}};e.formatMask=function(t,e,a,n){if(!t||isNaN(+e))return e;var r,o,i,l,u,s,h,d,c,m,f,g,p,b,_,v="",y=t.length,A=t.search(/[0-9\-\+#]/),x=A>0?t.substring(0,A):"",w=x;if(A>0&&a&&(w=/\{content\}/.test(a||"")?(a||"").replace(/\{content\}/g,x||""):(a||"")+x),_=t.split("").reverse().join(""),b=_.search(/[0-9\-\+#]/),p=y-b,p+="."===t.substring(p,p+1)?1:0,x=b>0?t.substring(p,y):"",v=x,""!==x&&n&&(v=/\{content\}/.test(n||"")?(n||"").replace(/\{content\}/g,x||""):x+(n||"")),t=t.substring(A,p),e="-"==t.charAt(0)?-e:+e,r=0>e?e=-e:0,o=t.match(/[^\d\-\+#]/g),i=o&&o[o.length-1]||".",l=o&&o[1]&&o[0]||",",t=t.split(i),e=e.toFixed(t[1]&&t[1].length),e=+e+"",s=t[1]&&t[1].lastIndexOf("0"),d=e.split("."),(!d[1]||d[1]&&d[1].length<=s)&&(e=(+e).toFixed(s+1)),c=t[0].split(l),t[0]=c.join(""),u=t[0]&&t[0].indexOf("0"),u>-1)for(;d[0].length<t[0].length-u;)d[0]="0"+d[0];else 0===+d[0]&&(d[0]="");if(e=e.split("."),e[0]=d[0],h=c[1]&&c[c.length-1].length){for(m=e[0],f="",g=m.length%h,y=m.length,p=0;y>p;p++)f+=m.charAt(p),!((p-g+1)%h)&&y-h>p&&(f+=l);e[0]=f}return e[1]=t[1]&&e[1]?i+e[1]:"",w+((r?"-":"")+e[0]+e[1])+v},e.equations={count:function(t){return t.length},sum:function(t){var e,a=t.length,n=0;for(e=0;a>e;e++)n+=t[e];return n},mean:function(t){var a=e.equations.sum(t);return a/t.length},median:function(t){var e,n=t.length;return n>1?(t.sort(function(t,e){return t-e}),e=Math.floor(n/2),n%2?t[e]:(t[e-1]+t[e])/2):a.invalid("median",1)},mode:function(t){var e,a,n,r={},o=1,i=[t[0]];for(e=0;e<t.length;e++)a=t[e],r[a]=r[a]?r[a]+1:1,n=r[a],n>o?(i=[a],o=n):n===o&&(i.push(a),o=n);return i.sort(function(t,e){return t-e})},max:function(t){return Math.max.apply(Math,t)},min:function(t){return Math.min.apply(Math,t)},range:function(t){var e=t.sort(function(t,e){return t-e});return e[t.length-1]-e[0]},variance:function(t,n){for(var r,o=e.equations.mean(t),i=0,l=t.length;l--;)i+=Math.pow(t[l]-o,2);return r=t.length-(n?0:1),0===r?a.invalid("variance",0):i/=r},varp:function(t){return e.equations.variance(t,!0)},vars:function(t){return e.equations.variance(t)},stdevs:function(t){var a=e.equations.variance(t);return Math.sqrt(a)},stdevp:function(t){var a=e.equations.variance(t,!0);return Math.sqrt(a)}},e.addWidget({id:"math",priority:100,options:{math_data:"math",math_ignore:[],math_mask:"#,##0.00",math_complete:null,math_priority:["row","above","col"],math_prefix:"",math_suffix:"",math_event:"recalculate"},init:function(t,n,r,o){var i=e.hasWidget(t,"filter")?"filterEnd":"updateComplete";r.$table.off((a.events+" updateComplete.tsmath "+o.math_event).replace(/\s+/g," ")).on(a.events+" "+o.math_event,function(t){var n="tablesorter-initialized"===t.type;(!o.math_isUpdating||n)&&(/filter/.test(t.type)||e.computeColumnIndex(r.$table.children("tbody").children()),a.recalculate(r,o,n))}).on(i+".tsmath",function(){setTimeout(function(){o.math_isUpdating&&r.debug&&console.groupEnd&&console.groupEnd(),o.math_isUpdating=!1},40)}),o.math_isUpdating=!1,t.hasInitialized&&a.recalculate(r,o,!0)},remove:function(t,e,n,r){r||e.$table.off((a.events+" updateComplete.tsmath "+n.math_event).replace(/\s+/g," ")).find("[data-"+n.math_data+"]").empty()}})}(jQuery);