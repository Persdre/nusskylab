!function(i){"use strict";var d=i.tablesorter,n=".tscolsel",p=d.columnSelector={queryAll:"@media only all { [columns] { display: none; } } ",queryBreak:"@media all and (min-width: [size]) { [columns] { display: table-cell; } } ",init:function(e,t,o){var l,a;return(l=i(o.columnSelector_layout)).find("input").add(l.filter("input")).length?(t.$table.addClass(t.namespace.slice(1)+"columnselector"),(a=t.selector={$container:i(o.columnSelector_container||"<div>")}).$style=i("<style></style>").prop("disabled",!0).appendTo("head"),a.$breakpoints=i("<style></style>").prop("disabled",!0).appendTo("head"),a.isInitializing=!0,p.setupSelector(t,o),o.columnSelector_mediaquery&&p.setupBreakpoints(t,o),a.isInitializing=!1,a.$container.length?p.updateCols(t,o):t.debug&&console.warn("ColumnSelector: >> container not found"),void t.$table.off("refreshColumnSelector"+n).on("refreshColumnSelector"+n,function(e,t,o){p.refreshColumns(this.config,t,o)})):void(t.debug&&console.error("ColumnSelector: >> ERROR: Column Selector aborting, no input found in the layout! ***"))},refreshColumns:function(e,t,o){var l,a,n=i.isArray(o||t),c=e.widgetOptions;if(void 0!==t&&e.selector.$container.length){if("selectors"===t&&(e.selector.$container.empty(),p.setupSelector(e,c),p.setupBreakpoints(e,c),void 0===o&&(o=e.selector.auto)),n)for(a=o||t,i.each(a,function(e,t){a[e]=parseInt(t,10)}),l=0;l<e.columns;l++)e.selector.$container.find("input[data-column="+l+"]").prop("checked",0<=i.inArray(l,a));p.updateAuto(e,c,e.selector.$container.find('input[data-column="auto"]').prop("checked",!0===o||!0===t||"auto"===t&&!1!==o))}else p.updateBreakpoints(e,c),p.updateCols(e,c)},setupSelector:function(a,n){var c,r=a.selector,u=r.$container,e=n.columnSelector_saveColumns&&d.storage,s=e?d.storage(a.table,"tablesorter-columnSelector"):[],t=e?d.storage(a.table,"tablesorter-columnSelector-auto"):{};r.auto=i.isEmptyObject(t)||"boolean"!==i.type(t.auto)?n.columnSelector_mediaqueryState:t.auto,r.states=[],r.$column=[],r.$wrapper=[],r.$checkbox=[],a.$table.children("thead").find("tr:first th",a.table).each(function(){var e=i(this),t=e.attr(n.columnSelector_priority)||1,o=e.attr("data-column"),l=d.getData(this,a.headers[o],"columnSelector");return!!(isNaN(t)&&0<t.length||"disable"===l||n.columnSelector_columns[o]&&"disable"===n.columnSelector_columns[o])||(r.states[o]=s&&"undefined"!=typeof s[o]?s[o]:"undefined"!=typeof n.columnSelector_columns[o]?n.columnSelector_columns[o]:"true"===l||"false"!==l,r.$column[o]=i(this),c=e.attr(n.columnSelector_name)||e.text(),void(u.length&&(r.$wrapper[o]=i(n.columnSelector_layout.replace(/\{name\}/g,c)).appendTo(u),r.$checkbox[o]=r.$wrapper[o].find("input").add(r.$wrapper[o].filter("input")).attr("data-column",o).toggleClass(n.columnSelector_cssChecked,r.states[o]).prop("checked",r.states[o]).on("change",function(){r.states[o]=this.checked,p.updateCols(a,n)}).change())))})},setupBreakpoints:function(e,t){var o=e.selector;t.columnSelector_mediaquery&&(o.lastIndex=-1,p.updateBreakpoints(e,t),e.$table.off("updateAll"+n).on("updateAll"+n,function(){p.updateBreakpoints(e,t),p.updateCols(e,t)})),o.$container.length&&(t.columnSelector_mediaquery&&(o.$auto=i(t.columnSelector_layout.replace(/\{name\}/g,t.columnSelector_mediaqueryName)).prependTo(o.$container),o.$auto.find("input").add(o.$auto.filter("input")).attr("data-column","auto").prop("checked",o.auto).toggleClass(t.columnSelector_cssChecked,o.auto).on("change",function(){p.updateAuto(e,t,i(this))}).change()),e.$table.off("update"+n).on("update"+n,function(){p.updateCols(e,t)}))},updateAuto:function(e,t,o){var l=e.selector;l.auto=o.prop("checked")||!1,i.each(l.$checkbox,function(e,t){t&&(t[0].disabled=l.auto,l.$wrapper[e].toggleClass("disabled",l.auto))}),t.columnSelector_mediaquery&&p.updateBreakpoints(e,t),p.updateCols(e,t),e.selector.$popup&&e.selector.$popup.find(".tablesorter-column-selector").html(l.$container.html()).find("input").each(function(){var e=i(this).attr("data-column");i(this).prop("checked","auto"===e?l.auto:l.states[e])}),t.columnSelector_saveColumns&&d.storage&&d.storage(e.$table[0],"tablesorter-columnSelector-auto",{auto:l.auto}),l.auto&&e.$table.trigger(t.columnSelector_updated)},updateBreakpoints:function(e,t){var o,l,a,n,c=e.selector,r=e.namespace+"columnselector",u=[],s="";if(t.columnSelector_mediaquery&&!c.auto)return c.$breakpoints.prop("disabled",!0),void c.$style.prop("disabled",!1);for(o=0;o<6;o++)a=[],e.$headers.filter("["+t.columnSelector_priority+"="+(o+1)+"]").each(function(){l=parseInt(i(this).attr("data-column"),10)+1,n=" col:nth-child("+l+")",a.push(r+n+","+r+"_extra_table"+n),n=" tr th:nth-child("+l+")",a.push(r+n+","+r+"_extra_table"+n),n=" tr td:nth-child("+l+")",a.push(r+n+","+r+"_extra_table"+n)}),a.length&&(u=u.concat(a),s+=p.queryBreak.replace(/\[size\]/g,t.columnSelector_breakpoints[o]).replace(/\[columns\]/g,a.join(",")));c.$style&&c.$style.prop("disabled",!0),u.length&&c.$breakpoints.prop("disabled",!1).html(p.queryAll.replace(/\[columns\]/g,u.join(","))+s)},updateCols:function(e,t){if(!(t.columnSelector_mediaquery&&e.selector.auto||e.selector.isInitializing)){var o,l,a=e.selector,n=[],c=e.namespace+"columnselector";a.$container.find("input[data-column]").filter('[data-column!="auto"]').each(function(){this.checked||(o=parseInt(i(this).attr("data-column"),10)+1,l=" col:nth-child("+o+")",n.push(c+l+","+c+"_extra_table"+l),l=" tr th:nth-child("+o+")",n.push(c+l+","+c+"_extra_table"+l),l=" tr td:nth-child("+o+")",n.push(c+l+","+c+"_extra_table"+l)),i(this).toggleClass(t.columnSelector_cssChecked,this.checked)}),t.columnSelector_mediaquery&&a.$breakpoints.prop("disabled",!0),a.$style&&a.$style.prop("disabled",!1).html(n.length?n.join(",")+" { display: none; }":""),t.columnSelector_saveColumns&&d.storage&&d.storage(e.$table[0],"tablesorter-columnSelector",a.states),e.$table.trigger(t.columnSelector_updated)}},attachTo:function(e,t){var o,l,a,n=(e=i(e)[0]).config,c=i(t);c.length&&n&&(c.find(".tablesorter-column-selector").length||c.append('<span class="tablesorter-column-selector"></span>'),o=n.selector,l=n.widgetOptions,c.find(".tablesorter-column-selector").html(o.$container.html()).find("input").each(function(){var e=i(this).attr("data-column"),t="auto"===e?o.auto:o.states[e];i(this).toggleClass(l.columnSelector_cssChecked,t).prop("checked",t)}),o.$popup=c.on("change","input",function(){a=i(this).toggleClass(l.columnSelector_cssChecked,this.checked).attr("data-column"),o.$container.find('input[data-column="'+a+'"]').prop("checked",this.checked).trigger("change")}))}};d.addWidget({id:"columnSelector",priority:10,options:{columnSelector_container:null,columnSelector_columns:{},columnSelector_saveColumns:!0,columnSelector_layout:'<label><input type="checkbox">{name}</label>',columnSelector_name:"data-selector-name",columnSelector_mediaquery:!0,columnSelector_mediaqueryName:"Auto: ",columnSelector_mediaqueryState:!0,columnSelector_breakpoints:["20em","30em","40em","50em","60em","70em"],columnSelector_priority:"data-priority",columnSelector_cssChecked:"checked",columnSelector_updated:"columnUpdate"},init:function(e,t,o,l){p.init(e,o,l)},remove:function(e,t,o,l){if(!l){var a=t.selector;a.$container.empty(),a.$popup&&a.$popup.empty(),a.$style.remove(),a.$breakpoints.remove(),t.$table.off("updateAll"+n+" update"+n)}}})}(jQuery);