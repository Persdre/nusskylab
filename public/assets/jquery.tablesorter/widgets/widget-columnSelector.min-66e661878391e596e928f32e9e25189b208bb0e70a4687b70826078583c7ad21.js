!function(e){"use strict";var t=e.tablesorter,o=".tscolsel",l=t.columnSelector={queryAll:"@media only all { [columns] { display: none; } } ",queryBreak:"@media all and (min-width: [size]) { [columns] { display: table-cell; } } ",init:function(t,a,n){var c,r;return c=e(n.columnSelector_layout),c.find("input").add(c.filter("input")).length?(a.$table.addClass(a.namespace.slice(1)+"columnselector"),r=a.selector={$container:e(n.columnSelector_container||"<div>")},r.$style=e("<style></style>").prop("disabled",!0).appendTo("head"),r.$breakpoints=e("<style></style>").prop("disabled",!0).appendTo("head"),r.isInitializing=!0,l.setupSelector(a,n),n.columnSelector_mediaquery&&l.setupBreakpoints(a,n),r.isInitializing=!1,r.$container.length?l.updateCols(a,n):a.debug&&console.warn("ColumnSelector: >> container not found"),void a.$table.off("refreshColumnSelector"+o).on("refreshColumnSelector"+o,function(e,t,o){l.refreshColumns(this.config,t,o)})):void(a.debug&&console.error("ColumnSelector: >> ERROR: Column Selector aborting, no input found in the layout! ***"))},refreshColumns:function(t,o,a){var n,c,r=e.isArray(a||o),u=t.widgetOptions;if(void 0!==o&&t.selector.$container.length){if("selectors"===o&&(t.selector.$container.empty(),l.setupSelector(t,u),l.setupBreakpoints(t,u),void 0===a&&(a=t.selector.auto)),r)for(c=a||o,e.each(c,function(e,t){c[e]=parseInt(t,10)}),n=0;n<t.columns;n++)t.selector.$container.find("input[data-column="+n+"]").prop("checked",e.inArray(n,c)>=0);l.updateAuto(t,u,t.selector.$container.find('input[data-column="auto"]').prop("checked",!0===a||!0===o||"auto"===o&&!1!==a))}else l.updateBreakpoints(t,u),l.updateCols(t,u)},setupSelector:function(o,a){var n,c=o.selector,r=c.$container,u=a.columnSelector_saveColumns&&t.storage,s=u?t.storage(o.table,"tablesorter-columnSelector"):[],i=u?t.storage(o.table,"tablesorter-columnSelector-auto"):{};c.auto=e.isEmptyObject(i)||"boolean"!==e.type(i.auto)?a.columnSelector_mediaqueryState:i.auto,c.states=[],c.$column=[],c.$wrapper=[],c.$checkbox=[],o.$table.children("thead").find("tr:first th",o.table).each(function(){var u=e(this),i=u.attr(a.columnSelector_priority)||1,d=u.attr("data-column"),p=t.getData(this,o.headers[d],"columnSelector");return!!(isNaN(i)&&i.length>0||"disable"===p||a.columnSelector_columns[d]&&"disable"===a.columnSelector_columns[d])||(c.states[d]=s&&"undefined"!=typeof s[d]?s[d]:"undefined"!=typeof a.columnSelector_columns[d]?a.columnSelector_columns[d]:"true"===p||"false"!==p,c.$column[d]=e(this),n=u.attr(a.columnSelector_name)||u.text(),void(r.length&&(c.$wrapper[d]=e(a.columnSelector_layout.replace(/\{name\}/g,n)).appendTo(r),c.$checkbox[d]=c.$wrapper[d].find("input").add(c.$wrapper[d].filter("input")).attr("data-column",d).toggleClass(a.columnSelector_cssChecked,c.states[d]).prop("checked",c.states[d]).on("change",function(){c.states[d]=this.checked,l.updateCols(o,a)}).change())))})},setupBreakpoints:function(t,a){var n=t.selector;a.columnSelector_mediaquery&&(n.lastIndex=-1,l.updateBreakpoints(t,a),t.$table.off("updateAll"+o).on("updateAll"+o,function(){l.updateBreakpoints(t,a),l.updateCols(t,a)})),n.$container.length&&(a.columnSelector_mediaquery&&(n.$auto=e(a.columnSelector_layout.replace(/\{name\}/g,a.columnSelector_mediaqueryName)).prependTo(n.$container),n.$auto.find("input").add(n.$auto.filter("input")).attr("data-column","auto").prop("checked",n.auto).toggleClass(a.columnSelector_cssChecked,n.auto).on("change",function(){l.updateAuto(t,a,e(this))}).change()),t.$table.off("update"+o).on("update"+o,function(){l.updateCols(t,a)}))},updateAuto:function(o,a,n){var c=o.selector;c.auto=n.prop("checked")||!1,e.each(c.$checkbox,function(e,t){t&&(t[0].disabled=c.auto,c.$wrapper[e].toggleClass("disabled",c.auto))}),a.columnSelector_mediaquery&&l.updateBreakpoints(o,a),l.updateCols(o,a),o.selector.$popup&&o.selector.$popup.find(".tablesorter-column-selector").html(c.$container.html()).find("input").each(function(){var t=e(this).attr("data-column");e(this).prop("checked","auto"===t?c.auto:c.states[t])}),a.columnSelector_saveColumns&&t.storage&&t.storage(o.$table[0],"tablesorter-columnSelector-auto",{auto:c.auto}),c.auto&&o.$table.trigger(a.columnSelector_updated)},updateBreakpoints:function(t,o){var a,n,c,r,u=t.selector,s=t.namespace+"columnselector",i=[],d="";if(o.columnSelector_mediaquery&&!u.auto)return u.$breakpoints.prop("disabled",!0),void u.$style.prop("disabled",!1);for(a=0;6>a;a++)c=[],t.$headers.filter("["+o.columnSelector_priority+"="+(a+1)+"]").each(function(){n=parseInt(e(this).attr("data-column"),10)+1,r=" col:nth-child("+n+")",c.push(s+r+","+s+"_extra_table"+r),r=" tr th:nth-child("+n+")",c.push(s+r+","+s+"_extra_table"+r),r=" tr td:nth-child("+n+")",c.push(s+r+","+s+"_extra_table"+r)}),c.length&&(i=i.concat(c),d+=l.queryBreak.replace(/\[size\]/g,o.columnSelector_breakpoints[a]).replace(/\[columns\]/g,c.join(",")));u.$style&&u.$style.prop("disabled",!0),i.length&&u.$breakpoints.prop("disabled",!1).html(l.queryAll.replace(/\[columns\]/g,i.join(","))+d)},updateCols:function(o,l){if(!(l.columnSelector_mediaquery&&o.selector.auto||o.selector.isInitializing)){var a,n,c=o.selector,r=[],u=o.namespace+"columnselector";c.$container.find("input[data-column]").filter('[data-column!="auto"]').each(function(){this.checked||(a=parseInt(e(this).attr("data-column"),10)+1,n=" col:nth-child("+a+")",r.push(u+n+","+u+"_extra_table"+n),n=" tr th:nth-child("+a+")",r.push(u+n+","+u+"_extra_table"+n),n=" tr td:nth-child("+a+")",r.push(u+n+","+u+"_extra_table"+n)),e(this).toggleClass(l.columnSelector_cssChecked,this.checked)}),l.columnSelector_mediaquery&&c.$breakpoints.prop("disabled",!0),c.$style&&c.$style.prop("disabled",!1).html(r.length?r.join(",")+" { display: none; }":""),l.columnSelector_saveColumns&&t.storage&&t.storage(o.$table[0],"tablesorter-columnSelector",c.states),o.$table.trigger(l.columnSelector_updated)}},attachTo:function(t,o){t=e(t)[0];var l,a,n,c=t.config,r=e(o);r.length&&c&&(r.find(".tablesorter-column-selector").length||r.append('<span class="tablesorter-column-selector"></span>'),l=c.selector,a=c.widgetOptions,r.find(".tablesorter-column-selector").html(l.$container.html()).find("input").each(function(){var t=e(this).attr("data-column"),o="auto"===t?l.auto:l.states[t];e(this).toggleClass(a.columnSelector_cssChecked,o).prop("checked",o)}),l.$popup=r.on("change","input",function(){n=e(this).toggleClass(a.columnSelector_cssChecked,this.checked).attr("data-column"),l.$container.find('input[data-column="'+n+'"]').prop("checked",this.checked).trigger("change")}))}};t.addWidget({id:"columnSelector",priority:10,options:{columnSelector_container:null,columnSelector_columns:{},columnSelector_saveColumns:!0,columnSelector_layout:'<label><input type="checkbox">{name}</label>',columnSelector_name:"data-selector-name",columnSelector_mediaquery:!0,columnSelector_mediaqueryName:"Auto: ",columnSelector_mediaqueryState:!0,columnSelector_breakpoints:["20em","30em","40em","50em","60em","70em"],columnSelector_priority:"data-priority",columnSelector_cssChecked:"checked",columnSelector_updated:"columnUpdate"},init:function(e,t,o,a){l.init(e,o,a)},remove:function(e,t,l,a){if(!a){var n=t.selector;n.$container.empty(),n.$popup&&n.$popup.empty(),n.$style.remove(),n.$breakpoints.remove(),t.$table.off("updateAll"+o+" update"+o)}}})}(jQuery);